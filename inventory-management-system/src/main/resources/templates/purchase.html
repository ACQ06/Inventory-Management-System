<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- Link to external stylesheet -->
        <link rel="stylesheet" type="text/css" href="../static/styles/purchase_style.css" />
        <!-- Link to Google Fonts for Material Symbols -->
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
        />
         <title>Template</title>
        <title>Template</title>
    </head>
    <body>
        <!-- Sidebar section -->
        <section class="sidebar">
            <div class="nav-section">
                <ul>
                    <li>
                        <a href="index.html" class="sidebar-link">
                            <span class="material-symbols-outlined">
                                dashboard
                            </span>
                            <span class="nav-item">Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="inventory.html" class="sidebar-link">
                            <span class="material-symbols-outlined">
                                inventory_2
                            </span>
                            <span class="nav-item">Inventory</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="sidebar-link">
                            <span class="material-symbols-outlined">
                                shopping_cart
                            </span>
                            <span class="nav-item">Sale</span>
                        </a>
                    </li>
                    <li>
                        <a href="purchase.html" class="sidebar-link">
                            <span class="material-symbols-outlined">
                                receipt
                            </span>
                            <span class="nav-item">Purchase</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="sidebar-link">
                            <span class="material-symbols-outlined">
                                groups
                            </span>
                            <span class="nav-item">Supplier</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="sidebar-link">
                            <span class="material-symbols-outlined">
                                settings
                            </span>
                            <span class="nav-item">Settings</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- User logout section -->
            <div class="user-logout">
                <div class="user">
                    <span class="material-symbols-outlined logout-icon">
                        move_item
                    </span>

                    <div class="user-details">
                        <div>
                            <p class="user-name">Name</p>
                            <p class="user-role">Role</p>
                        </div>
                    </div>
                    <span class="material-symbols-outlined" href> person </span>
                </div>
            </div>
        </section>
        <!-- Main content area -->
        <main class="main-content">
            <h1>Purchase</h1>
            <div class="row">
                <div class="column">
                  <div id="first" >
                        <div class = "purchase-order">
                            <h5 style="font-size:30px">Create Purchase Order</h5>
                            
                            
                            <button class ="button-Edit" onclick="editPurchaseTable()">
                                Edit
                            </button>
                            
                        </div>
                        <div class = "purchase"></div>
                        <div class="user-purchase">
                        <div class="row">
                            <div class="column">
                            <label for="userInput" >
                            User:  
                            </label>
                            <input type="text" id="userInput" placeholder="Input user name...">
                            <br>
                            <label for="purchaseIdInput" >
                                Purchase ID: 
                                </label>
                                <label id="purchaseId">
                                    <script>
                                        const characters ='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                                        const purchaseID = document.getElementById('purchaseId');
                                        
                                        function generateString(length) {
                                            let result = ' ';
                                            const charactersLength = characters.length;
                                            for ( let i = 0; i < length; i++ ) {
                                            result += characters.charAt(Math.floor(Math.random() * charactersLength));
                                            }

                                        return result;
                                        }
                                        purchaseID.innerHTML = generateString(10);
                                        

                                    </script>
                                </label>
                            <br>
                            <label for="dateInput" >
                                Date: 
                                </label>
                                <input type="date" id="dateID" placeholder="">
                            </div>
                            <div class="column">
                                <label for="status" >
                                    Status:  
                                    </label>
                                    <input type="text" id="status" placeholder="order status">
                                    <br>
                                    <label for="manager" >
                                        Manager:  
                                        </label>
                                        <input type="text" id="manager" placeholder="Input manager name">
                                        <br>
                                
                            </div>
                        </div>
                        </div>
                    <div class="scrollable">
                    <table id="orderTable">
                        <thread> 
                            <tr>
                                <th>Item </th>
                                <th>Item ID</th>
                                <th>Price </th>
                                <th>Quantity </th>
                                <th>Amount </th>
                            </tr>
                        </thread>
                        <tbody>
                            <tr>
                                <td contenteditable="false">Item1</td>
                                <td contenteditable="false">A1213</td>
                                <td contenteditable="false">PHP 10.00</td>
                                <td contenteditable="false">500</td>
                                <td contenteditable="false">PHP 5,000.00</td>
                            </tr>
                        </tbody> 
                    </table>
                </div>
                    
                    <button id="saveChangesBtn" onclick="saveChanges()" style="display: none;">save</button>

                    <script>

                    let originalContent = []; 
                    
                    function editPurchaseTable() {

                        
                    const ordTable = document.getElementById("orderTable").getElementsByTagName("tbody")[0];

                       for (let i=0; i<ordTable.rows.length;i++){
                        const rows = ordTable.rows[i];

                        // make each cell editable
                            for (let j=1;j <rows.cells.length;j++){
                                rows.cells[j].setAttribute("contenteditable","true");
                                }
                            }
                       
                       // save button will appear
                        var saveBtn = document.getElementById('saveChangesBtn');
                        saveBtn.style.display = "inline-block";

                    }
                    
                  
                    function saveChanges() {
                        const ordTable = document.getElementById("orderTable").getElementsByTagName("tbody")[0];
                        let content_to_save = [];
                        var cells = ordTable.getElementsByTagName('td');
                        var rows = ordTable.getElementsByTagName('tr');

                        // makes each cell uneditable and changes the contents of original array
                        for (let i =0; i<ordTable.rows.length;i++){
                        const rows = ordTable.rows[i];
                        const newRow = [];
                        for (let j=1;j <rows.cells.length;j++){
                            rows.cells[j].setAttribute("contenteditable","false");
                            newRow.push(rows.cells[j].textContent);
                        }
                        content_to_save.push(newRow);
                       }
                       originalContent = content_to_save;
                        

                        console.log("Changes saved:", originalContent);
                        alert("Changes saved!");
                       // save button will be hidden
                        var saveBtn = document.getElementById('saveChangesBtn');
                        saveBtn.style.display ="none";
        
                }
            
                    </script>

                    <!-- add icon here -->
                    <button class="button-Icon">
                        <span class="material-symbols-outlined" onclick="addNewRow()">
                            add_circle
                        </span>
                    </button>
                    
                    <script>

                        var addedRows = [];    
                        function addNewRow(){
                            var orderTable = document.getElementById("orderTable");
                            var rows = orderTable.rowslength;
                            var r = orderTable.insertRow(rows);
                            var c1 = r.insertCell(0);
                            var c2 = r.insertCell(1);
                            var c3 = r.insertCell(2);
                            var c4 = r.insertCell(3);
                            var c5 = r.insertCell(4);

                            var item = document.createElement("select");
                            var item1 = document.createElement("option");
                            item1.text = "Item 1";
                            var item2 = document.createElement("option");
                            item2.text = "Item 2";
                            var item3 = document.createElement("option");
                            item3.text = "Item 3";

                            item.add(item1);
                            item.add(item2);
                            item.add(item3);

                            var itemId = document.createElement("input");
                            var price = document.createElement("input");
                            var quantity = document.createElement("input");
                            var amount = document.createElement("input"); 
                            
                            item.type = "text";
                            itemId.type = "text";
                            price.type = "text";
                            quantity.type = "number";
                            amount.type = "text";

                            item.style.width = "4vw";
                            itemId.style.width="2vw";
                            price.style.width="4vw";
                            quantity.style.width="3vw";
                            amount.style.width="4vw";

                            c1.appendChild(item);
                            c2.appendChild(itemId);
                            c3.appendChild(price);
                            c4.appendChild(quantity);
                            c5.appendChild(amount);

                            quantity.addEventListener('input', function(){
                                if (quantity.value < 0) {
                                    quantity.value = 0;
                                }
                            });

                            addedRows.push({
                                item: item.value,
                                itemId: itemId.value,
                                price: price.value,
                                quantity: quantity.value,
                                amount: amount.value
                            });

                            // make a save button appear
                            var saveBtn = document.getElementById('saveChangesBtn');
                            saveBtn.style.display = "inline-block";
                            }
                            
                            //function saveAllRows(){
                            //    var orderTable = docume.getElementById("orderTable");

                            //    for (var i = 0; i < addedRows.length; i++){
                             //       var rowData = addedRows[i];
                             //       var newRow = orderTable.insertRow(orderTable.rows.length);
                             //       var c1 = newRow.insertCell(0);
                             //       var c2 = newRow.insertCell(1);
                             //       var c3 = newRow.insertCell(2);
                             //       var c4 = newRow.insertCell(3);
                             //       var c5 = newRow.insertCell(4);

                             //       c1.innerHTML = '<label>' + rowData.item + '</label>';
                             //       c2.innerHTML = '<label>' + rowData.itemId + '</label>';
                             //       c3.innerHTML = '<label>' + rowData.price + '</label>';
                             //       c4.innerHTML = '<label>' + rowData.quantity + '</label>';
                             //       c5.innerHTML = '<label>' + rowData.amount + '</label>';
                              //  }

                              //  addedRows = [];
                              //  var saveBtn = documet.getElementById('saveChangesBtn');
                              //  saveBtn.styel.display = 'none';
                           // }
                    </script>

                    <!-- total amount (50% of the panel) -->
                    <div class="total-button">
                        <div class="column">
                            <!-- empty space in total amount for comment -->
                            <label for="comment" >
                                Comment:  
                                </label>
                                <textarea id="comment" placeholder="input comment"></textarea>
                                <br>
                        </div>
                        <div class="column">
                            <div class="row">
                                <div class="column">Total Amount:</div>
                                <div class="total-column"><strong>PHP 5,000.00</strong></div>
                            </div>
                        </div>
                    </div>
                    <!-- Create order button goes here -->
                    <div class = "purchase-button">
                        
                        <button class = "button-Order">
                            Create Order
                        </button>
                        <script>
                            // add the created order to the database
                        </script>
                    </div>
                  </div>
                </div>
                <div class="column">
                  
                  <div id="first">
                    <div class = "purchase-history">
                        <h5 style="font-size:30px; float: left"> <span>Purchase History</span></h5>
                        <h5 style="font-size:30px; float: right"> <span>MAY 2024</span></h5>
                    </div>
                    <div class = "history"> </div>
                    
                    <table> 
                        <tr>
                            <th>Date </th>
                            <th>User </th>
                            <th>Purchase ID </th>
                            <th>Manager</th>
                            <th>Status</th>
                            <th>Amount </th>
                        </tr>
                        <tr>
                            <td>5/10/2024</td>
                            <td>Hu Tao</td>
                            <td>2024715</td>
                            <td>Zhongli</td>
                            <td>Paid</td>
                            <td>PHP 10,000.00</td>
                        </tr>

                    </table>
                    <div class="total-button">
                        <div class="column">
                            <!-- empty space in total amount -->
                        </div>
                        <div class="column">
                            <div class="row">
                                <div class="column"><bold>Total Sales:</bold></div>
                                <div class="total-column" ><strong>PHP 10,000.00</strong></div>
                            </div>
                        </div>
                    </div>
                    <div class="history-button">
                        <div class="row"> 
                            <div class="column-history" >
                            <button class = "button-Back">Back</button></div>
                            <div class="column-history">
                            <button class = "button-Delete">Delete Order</button></div>
                            <div class="column-history" >
                            <button class = "button-Next">Next</button></div>
                        </div>
                    </div>
                    
                </div>
                </div>
            </div>
        </main>
    </body>
</html>
